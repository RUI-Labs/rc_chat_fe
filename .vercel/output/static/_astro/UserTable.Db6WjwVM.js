import{u as A,g as L,a as U,F as K,T as q,b as z,c as O,d as E,e as P,f as W}from"./TableRow.4Kn-oSxF.js";import{_ as M}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{B as S}from"./index.DUM513om.js";import{D as Y,a as G,b as J,c as Q,d as X,e as Z,f as $}from"./DialogFooter.DtzIYxse.js";import{L as ee}from"./Label.B320eMaW.js";import{T as te}from"./Textarea.D9scu3iE.js";import{m as H,g as j,r as p,a as i,b as D,i as s,h as l,p as ae,l as T,d as c,t as C,c as b,F as w,e as y,P as r,j as se,f as le}from"./runtime-core.esm-bundler.C8n-v3-D.js";import"./utils.CFP4Y51R.js";import"./runtime-dom.esm-bundler.CkxCeCJQ.js";import"./createLucideIcon.CCYx18s6.js";import"./index.LclF5nvU.js";const re=H({__name:"BroadcastDialog",props:{recipients:{type:Array,required:!0}},setup(x,{expose:d}){const v=x,{recipients:e}=j(v),u=p(!1),h=()=>{u.value=!0},a=()=>{u.value=!1};d({show:h,hide:a});const o=p(""),k=p(""),f=p(""),B={props:v,recipients:e,open:u,show:h,hide:a,inputTitle:o,inputTag:k,inputMessage:f,confirmBroadcast:()=>{a()},get Button(){return S},get Dialog(){return Y},get DialogContent(){return G},get DialogDescription(){return J},get DialogFooter(){return Q},get DialogHeader(){return X},get DialogTitle(){return Z},get DialogTrigger(){return $},get Label(){return ee},get Textarea(){return te}};return Object.defineProperty(B,"__isScriptSetup",{enumerable:!1,value:!0}),B}}),oe={class:"border px-3 p-2 rounded-xl"},ne={class:"grid gap-4 py-4"},ie={class:""},de={class:"mb-2"};function ce(x,d,v,e,u,h){return i(),D(e.Dialog,{open:e.open,"onUpdate:open":d[2]||(d[2]=a=>e.open=a)},{default:s(()=>[l(e.DialogTrigger,null,{default:s(()=>[ae(x.$slots,"default")]),_:3}),l(e.DialogContent,{class:"sm:max-w-[425px]"},{default:s(()=>[l(e.DialogHeader,null,{default:s(()=>[l(e.DialogTitle,null,{default:s(()=>[T("New Broadcast")]),_:1}),l(e.DialogDescription,null,{default:s(()=>[T(" Broadcast a message to multiple users. ")]),_:1})]),_:1}),c("div",oe,[c("p",null,"Broadcasting to "+C(e.recipients?.length)+" Users",1)]),c("div",ne,[c("div",ie,[c("div",de,[l(e.Label,{for:"reply_message",class:"text-left"},{default:s(()=>[T(" Broadcast Message ")]),_:1})]),l(e.Textarea,{modelValue:e.inputMessage,"onUpdate:modelValue":d[0]||(d[0]=a=>e.inputMessage=a)},null,8,["modelValue"])])]),l(e.DialogFooter,null,{default:s(()=>[l(e.Button,{onClick:d[1]||(d[1]=a=>e.confirmBroadcast())},{default:s(()=>[T(" Broadcast ")]),_:1})]),_:1})]),_:1})]),_:3},8,["open"])}const ue=M(re,[["render",ce]]),ge=H({__name:"UserTable",props:["project_id"],setup(x,{expose:d}){d();const v=x,{project_id:e}=j(v),u=p([{id:"1",name:"Alice",address:"123 Lane",subscribed:!0,tags:["premium","new"]},{id:"2",name:"Bob",address:"456 Drive",subscribed:!1,tags:["standard"]},{id:"3",name:"Carol",address:"789 Way",subscribed:!0,tags:["premium","frequent"]}]),h=(t,n,m)=>m.length===0||m.some(_=>t.getValue(n).includes(_)),a=[{accessorKey:"name",header:()=>r("div",{class:"text-blue-200 font-brand"},"Name"),cell:({row:t})=>r("div",{class:"text-white"},t.getValue("name"))},{accessorKey:"id",header:()=>r("div",{class:"text-blue-200 font-brand"},"ID"),cell:({row:t})=>r("div",{class:"text-white"},t.getValue("id"))},{accessorKey:"address",header:()=>r("div",{class:"text-blue-200 font-brand"},"Address"),cell:({row:t})=>r("div",{class:"text-white"},t.getValue("address"))},{accessorKey:"subscribed",header:()=>r("div",{class:"text-blue-200 font-brand"},"Subscribed"),cell:({row:t})=>r("div",{class:"text-white"},t.getValue("subscribed")?"Yes":"No")},{accessorKey:"tags",header:()=>r("div",{class:"text-blue-200 font-brand"},"Tags"),cell:({row:t})=>r("div",{},t.getValue("tags").map(n=>r("span",{class:"px-3 py-1.5 bg-stone-700 text-white mx-1 rounded-full"},n))),filterFn:h}],o=p([]);a.unshift({id:"selection",header:()=>r("input",{type:"checkbox",checked:g.value.size===u.value.length,onChange:t=>{if(t.target.checked){const n=u.value.map(m=>m.id);g.value=new Set(n)}else g.value.clear()}}),cell:({row:t})=>r("input",{type:"checkbox",checked:g.value.has(t.original.id),onChange:()=>{const n=t.original.id;g.value.has(n)?g.value.delete(n):g.value.add(n)}})}),a.push({id:"chat",header:()=>r("div",{class:"text-blue-200 font-brand text-center"},"Chat"),cell:({row:t})=>r("div",{class:"flex justify-center"},[r("button",{onClick:()=>F(t.original.id),class:"border px-4 py-2 rounded-xl hover:bg-blue-500 hover:text-white hover:ring-2 hover:ring-blue-300 hover:ring-offset-2 duration-300 hover:scale-95 active:scale-75 flex justify-center items-center space-x-2 bg-gray-50"},"Chat")])});const k=A({data:u.value,columns:a,getCoreRowModel:L(),getFilteredRowModel:U(),state:{get columnFilters(){return o.value}}}),f=p([]),g=p(new Set),B=t=>{const n=f.value.indexOf(t);n>=0?f.value.splice(n,1):f.value.push(t),console.log(f.value),f.value.length>0?o.value=[{id:"tags",value:f.value}]:o.value=[]},I=se(()=>{const t=new Map;return u.value.forEach(m=>{m.tags.forEach(_=>{t.has(_)?t.set(_,t.get(_)+1):t.set(_,1)})}),Array.from(t.entries()).map(([m,_])=>({tag:m,count:_}))}),R=p([]),N=()=>{let t=u.value.filter(n=>g.value.has(n.id));R.value=t},F=t=>{console.log(`Opening chat for user ID: ${t}`)},V={props:v,project_id:e,users:u,tagFilterFn:h,columns:a,columnFilters:o,table:k,selectedTags:f,selectedRowIds:g,toggleTag:B,uniqueTags:I,broadcastRecipients:R,bulkselect:N,openChat:F,get FlexRender(){return K},get Table(){return q},get TableBody(){return z},get TableCell(){return O},get TableHead(){return E},get TableHeader(){return P},get TableRow(){return W},get Button(){return S},BroadcastDialog:ue};return Object.defineProperty(V,"__isScriptSetup",{enumerable:!1,value:!0}),V}}),be={class:"w-full h-full"},fe={class:"w-full p-4 py-2 text-white border-y border-y-stone-700 flex justify-between items-center"},pe={key:0},me={key:1},_e={class:"w-full grid-cols-5 grid h-full"},ve={class:"w-full border-r border-r-stone-700 py-4 px-2"},he=c("p",{class:"mb-4 text-sm font-semibold text-white"},"Tags",-1),xe={class:"w-full flex justify-between items-center"},Te={key:0},we={class:"w-full col-span-4"};function ye(x,d,v,e,u,h){return i(),b("div",be,[c("div",fe,[e.selectedRowIds.size!=0?(i(),b("div",pe," Selected: "+C(e.selectedRowIds.size)+" rows ",1)):(i(),b("div",me," Select Users to Broadcast ")),l(e.BroadcastDialog,{recipients:e.broadcastRecipients},{default:s(()=>[l(e.Button,{onClick:d[0]||(d[0]=a=>e.bulkselect()),disabled:e.selectedRowIds.size==0,class:"bg-blue-500 disabled:bg-stone-700 text-white hover:bg-blue-700"},{default:s(()=>[T("Broadcast")]),_:1},8,["disabled"])]),_:1},8,["recipients"])]),c("div",_e,[c("div",ve,[he,(i(!0),b(w,null,y(e.uniqueTags,a=>(i(),b("div",{key:a.tag,class:"w-full"},[l(e.Button,{class:"w-full text-left bg-stone-800 text-white mb-1",variant:"ghost",onClick:o=>e.toggleTag(a.tag)},{default:s(()=>[c("div",xe,[c("span",null,[c("strong",null,C(a.tag),1),T(" ("+C(a.count)+")",1)]),e.selectedTags.includes(a.tag)?(i(),b("span",Te,"âœ“")):le("",!0)])]),_:2},1032,["onClick"])]))),128))]),c("div",we,[l(e.Table,null,{default:s(()=>[l(e.TableHeader,null,{default:s(()=>[(i(!0),b(w,null,y(e.table.getHeaderGroups(),a=>(i(),D(e.TableRow,{class:"bg-stone-800 hover:bg-stone-700",key:a.id},{default:s(()=>[(i(!0),b(w,null,y(a.headers,o=>(i(),D(e.TableHead,{key:o.id},{default:s(()=>[l(e.FlexRender,{render:o.column.columnDef.header,props:o.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),l(e.TableBody,null,{default:s(()=>[(i(!0),b(w,null,y(e.table.getRowModel().rows,a=>(i(),D(e.TableRow,{class:"border-b-stone-700 hover:bg-stone-700",key:a.id},{default:s(()=>[(i(!0),b(w,null,y(a.getVisibleCells(),o=>(i(),D(e.TableCell,{key:o.id},{default:s(()=>[l(e.FlexRender,{render:o.column.columnDef.cell,props:o.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1024))),128))]),_:1})]),_:1})])])])}const Ie=M(ge,[["render",ye]]);export{Ie as default};
