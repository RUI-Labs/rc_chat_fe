import{c as o}from"./wagmiConfig.Chk1Y_fx.js";import{B as V}from"./index.DUM513om.js";import{_ as W}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{g as l,r as _,c as v,w as z}from"./watchConnections.CEVD3vQ5.js";import{g as u}from"./getAccount.CrAKNmNJ.js";import{d as y}from"./disconnect.fQnpZ0pp.js";import{s as S}from"./signMessage.bXjFpeGI.js";import{r as g,o as x,a as f,c as m,d as s,f as C,t as k,h as j,i as I,j as A,k as D,l as B}from"./runtime-core.esm-bundler.C8n-v3-D.js";import"./utils.CFP4Y51R.js";import"./runtime-dom.esm-bundler.CkxCeCJQ.js";import"./getConnectorClient.CvN7nnx2.js";const M={__name:"Siwe",setup(N,{expose:t}){t();const i=g(),e=g(),a=async()=>{try{let n=u(o);n&&(e.value=n.address)}catch{}};x(async()=>{i.value=l(o),i.value=i.value.filter(n=>n.id!="injected"),await _(o),await a()});const b={connectors:i,address:e,checkAccount:a,_connect:async n=>{const c=l(o).find(d=>d.id===n);await v(o,{connector:c}),await a()},_disconnect:async()=>{await y(o),e.value=null},startSIWE:async()=>{let{address:n,chainId:c}=u(o);console.log(c);let d=await fetch("/api/nonce.json",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({address:n})}),{nonce:O}=await d.json();const w=(p=>`Domain: ${window.location.host}
Address: ${n}
Statement: Sign in with Ethereum to the app.
URI: ${window.location.origin}
Version: 1
ChainId: ${c}
Nonce: ${O}`)(),T=await S(o,{message:w});let h=await fetch("/api/verify.json",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({address:n,message:w,signature:T})});if(h.ok){let p=await h.json();console.log(p),window.location.href="/admin"}},computed:A,onMounted:x,onUnmounted:D,ref:g,get config(){return o},get connect(){return v},get reconnect(){return _},get getAccount(){return u},get disconnect(){return y},get getConnectors(){return l},get watchConnections(){return z},get signMessage(){return S},get Button(){return V}};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}},P={class:"w-full"},$={key:0,class:"w-full flex flex-col space-y-2 justify-center items-center p-4"},J={key:1,class:"w-full"},R={class:"w-full flex justify-between items-center mb-12 border-y border-stone-800 bg-white/5 p-4"},U={class:"text-white"},K=s("p",{class:"text-sm font-semibold"},"Connected",-1),q={class:"w-full p-2"};function F(N,t,i,e,a,E){return f(),m("div",P,[e.address?C("",!0):(f(),m("div",$,[s("button",{onClick:t[0]||(t[0]=r=>e._connect("io.metamask")),class:"rounded-md bg-stone-700 border-stone-600 border text-white p-4 w-full hover:bg-stone-600 hover:ring-2 hover:ring-zinc-500 hover:ring-offset-2 duration-300"},"Metamask"),s("button",{onClick:t[1]||(t[1]=r=>e._connect("io.rabby")),class:"rounded-md bg-stone-700 border-stone-600 border text-white p-4 w-full hover:bg-stone-600 hover:ring-2 hover:ring-zinc-500 hover:ring-offset-2 duration-300"},"Rabby"),s("button",{onClick:t[2]||(t[2]=r=>e._connect("coinbaseWalletSDK")),class:"rounded-md bg-stone-700 border-stone-600 border text-white p-4 w-full hover:bg-stone-600 hover:ring-2 hover:ring-zinc-500 hover:ring-offset-2 duration-300"},"Coinbase Smart Wallet"),s("button",{onClick:t[3]||(t[3]=r=>e._connect("injected")),class:"rounded-md bg-stone-700 border-stone-600 border text-white p-4 w-full hover:bg-stone-600 hover:ring-2 hover:ring-zinc-500 hover:ring-offset-2 duration-300"},"Injected")])),e.address?(f(),m("div",J,[s("div",R,[s("div",U,[K,s("p",null,k(String(e.address).substr(0,6))+"..."+k(String(e.address).substr(-4)),1)]),j(e.Button,{variant:"outline",class:"bg-stone-700 border-stone-600 text-white",onClick:t[4]||(t[4]=r=>e._disconnect())},{default:I(()=>[B("Disconnect")]),_:1})]),s("div",q,[j(e.Button,{onClick:t[5]||(t[5]=r=>e.startSIWE()),class:"w-full bg-blue-500 hover:bg-blue-600 font-brand text-lg py-6"},{default:I(()=>[B("Sign In")]),_:1})])])):C("",!0)])}const ie=W(M,[["render",F]]);export{ie as default};
