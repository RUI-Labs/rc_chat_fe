import{c as pe}from"./wagmiConfig.Chk1Y_fx.js";import{g as Ne}from"./getAccount.CrAKNmNJ.js";import{_ as t,b as f,u as I,T as Oe,C as A,t as R}from"./getEthersSigner.DIrFHjWe.js";let c=[],Fe=(e,n)=>{let o=[],i={get(){return i.lc||i.listen(()=>{})(),i.value},l:0,lc:0,listen(r,l){return i.lc=o.push(r,l||i.l)/2,()=>{let u=o.indexOf(r);~u&&(o.splice(u,2),--i.lc||i.off())}},notify(r,l){let u=!c.length;for(let a=0;a<o.length;a+=2)c.push(o[a],o[a+1],i.value,r,l);if(u){for(let a=0;a<c.length;a+=5){let d;for(let s=a+1;!d&&(s+=5)<c.length;)c[s]<c[a+1]&&(d=c.push(c[a],c[a+1],c[a+2],c[a+3],c[a+4]));d||c[a](c[a+2],c[a+3],c[a+4])}c.length=0}},off(){},set(r){let l=i.value;l!==r&&(i.value=r,i.notify(l))},subscribe(r,l){let u=i.listen(r,l);return r(i.value),u},value:e};return i};/*! js-cookie v3.0.5 | MIT */function h(e){for(var n=1;n<arguments.length;n++){var o=arguments[n];for(var i in o)e[i]=o[i]}return e}var he={read:function(e){return e[0]==='"'&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function D(e,n){function o(r,l,u){if(!(typeof document>"u")){u=h({},n,u),typeof u.expires=="number"&&(u.expires=new Date(Date.now()+u.expires*864e5)),u.expires&&(u.expires=u.expires.toUTCString()),r=encodeURIComponent(r).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var a="";for(var d in u)u[d]&&(a+="; "+d,u[d]!==!0&&(a+="="+u[d].split(";")[0]));return document.cookie=r+"="+e.write(l,r)+a}}function i(r){if(!(typeof document>"u"||arguments.length&&!r)){for(var l=document.cookie?document.cookie.split("; "):[],u={},a=0;a<l.length;a++){var d=l[a].split("="),s=d.slice(1).join("=");try{var N=decodeURIComponent(d[0]);if(u[N]=e.read(s,N),r===N)break}catch{}}return r?u[r]:u}}return Object.create({set:o,get:i,remove:function(r,l){o(r,"",h({},l,{expires:-1}))},withAttributes:function(r){return D(this.converter,h({},this.attributes,r))},withConverter:function(r){return D(h({},this.converter,r),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(e)}})}var b=D(he,{path:"/"});const we="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let Se=(e=21)=>{let n="",o=crypto.getRandomValues(new Uint8Array(e));for(;e--;)n+=we[o[e]&63];return n};const Ye=()=>{const e=b.get("rc_cookie")||`race_${Se()}`;return b.get("rc_cookie")||b.set("rc_cookie",e),console.log("user_id",e),e},xe=()=>{const e=window?.OneSignal?.User.onesignalId,n=window?.OneSignal?.User,o=window?.OneSignal?.User.PushSubscription.id,i=window?.OneSignal?.Notifications.permission;console.log("getUserSubscriptionId",e,n,o,i);let r=Ne(pe);return o||`onesingal-${r?.address?.toLowerCase()}`},He=()=>Ne(pe)?.connector?.id==="coinbaseWalletSDK",be=new Array(64),Te=new Array(123);for(let e=0;e<64;)Te[be[e]=e<26?e+65:e<52?e+71:e<62?e-4:e-59|43]=e++;var U;(function(e){e.SORT_DIRECTION_UNSPECIFIED="SORT_DIRECTION_UNSPECIFIED",e.SORT_DIRECTION_ASCENDING="SORT_DIRECTION_ASCENDING",e.SORT_DIRECTION_DESCENDING="SORT_DIRECTION_DESCENDING"})(U||(U={}));var v=(()=>{if(typeof v<"u")return v;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw"Unable to locate global object"})();t.util.Long!==f&&(t.util.Long=f,t.configure());var C=(()=>{if(typeof C<"u")return C;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw"Unable to locate global object"})();t.util.Long!==f&&(t.util.Long=f,t.configure());var m=(()=>{if(typeof m<"u")return m;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw"Unable to locate global object"})();t.util.Long!==f&&(t.util.Long=f,t.configure());var P=(()=>{if(typeof P<"u")return P;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw"Unable to locate global object"})();t.util.Long!==f&&(t.util.Long=f,t.configure());var L;(function(e){e[e.CONSENT_PROOF_PAYLOAD_VERSION_UNSPECIFIED=0]="CONSENT_PROOF_PAYLOAD_VERSION_UNSPECIFIED",e[e.CONSENT_PROOF_PAYLOAD_VERSION_1=1]="CONSENT_PROOF_PAYLOAD_VERSION_1",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"})(L||(L={}));var M=(()=>{if(typeof M<"u")return M;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw"Unable to locate global object"})();t.util.Long!==f&&(t.util.Long=f,t.configure());t.util.Long!==f&&(t.util.Long=f,t.configure());var k=(()=>{if(typeof k<"u")return k;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw"Unable to locate global object"})();t.util.Long!==f&&(t.util.Long=f,t.configure());var g;(function(e){e[e.COMPRESSION_DEFLATE=0]="COMPRESSION_DEFLATE",e[e.COMPRESSION_GZIP=1]="COMPRESSION_GZIP",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"})(g||(g={}));function De(e){switch(e){case 0:case"COMPRESSION_DEFLATE":return g.COMPRESSION_DEFLATE;case 1:case"COMPRESSION_GZIP":return g.COMPRESSION_GZIP;case-1:case"UNRECOGNIZED":default:return g.UNRECOGNIZED}}function Re(e){switch(e){case g.COMPRESSION_DEFLATE:return"COMPRESSION_DEFLATE";case g.COMPRESSION_GZIP:return"COMPRESSION_GZIP";case g.UNRECOGNIZED:default:return"UNRECOGNIZED"}}function G(){return{authorityId:"",typeId:"",versionMajor:0,versionMinor:0}}const y={encode(e,n=t.Writer.create()){return e.authorityId!==""&&n.uint32(10).string(e.authorityId),e.typeId!==""&&n.uint32(18).string(e.typeId),e.versionMajor!==0&&n.uint32(24).uint32(e.versionMajor),e.versionMinor!==0&&n.uint32(32).uint32(e.versionMinor),n},decode(e,n){const o=e instanceof t.Reader?e:new t.Reader(e);let i=n===void 0?o.len:o.pos+n;const r=G();for(;o.pos<i;){const l=o.uint32();switch(l>>>3){case 1:r.authorityId=o.string();break;case 2:r.typeId=o.string();break;case 3:r.versionMajor=o.uint32();break;case 4:r.versionMinor=o.uint32();break;default:o.skipType(l&7);break}}return r},fromJSON(e){return{authorityId:E(e.authorityId)?String(e.authorityId):"",typeId:E(e.typeId)?String(e.typeId):"",versionMajor:E(e.versionMajor)?Number(e.versionMajor):0,versionMinor:E(e.versionMinor)?Number(e.versionMinor):0}},toJSON(e){const n={};return e.authorityId!==void 0&&(n.authorityId=e.authorityId),e.typeId!==void 0&&(n.typeId=e.typeId),e.versionMajor!==void 0&&(n.versionMajor=Math.round(e.versionMajor)),e.versionMinor!==void 0&&(n.versionMinor=Math.round(e.versionMinor)),n},fromPartial(e){var n,o,i,r;const l=G();return l.authorityId=(n=e.authorityId)!==null&&n!==void 0?n:"",l.typeId=(o=e.typeId)!==null&&o!==void 0?o:"",l.versionMajor=(i=e.versionMajor)!==null&&i!==void 0?i:0,l.versionMinor=(r=e.versionMinor)!==null&&r!==void 0?r:0,l}};function F(){return{type:void 0,parameters:{},fallback:void 0,compression:void 0,content:new Uint8Array}}const Y={encode(e,n=t.Writer.create()){return e.type!==void 0&&y.encode(e.type,n.uint32(10).fork()).ldelim(),Object.entries(e.parameters).forEach(([o,i])=>{H.encode({key:o,value:i},n.uint32(18).fork()).ldelim()}),e.fallback!==void 0&&n.uint32(26).string(e.fallback),e.compression!==void 0&&n.uint32(40).int32(e.compression),e.content.length!==0&&n.uint32(34).bytes(e.content),n},decode(e,n){const o=e instanceof t.Reader?e:new t.Reader(e);let i=n===void 0?o.len:o.pos+n;const r=F();for(;o.pos<i;){const l=o.uint32();switch(l>>>3){case 1:r.type=y.decode(o,o.uint32());break;case 2:const u=H.decode(o,o.uint32());u.value!==void 0&&(r.parameters[u.key]=u.value);break;case 3:r.fallback=o.string();break;case 5:r.compression=o.int32();break;case 4:r.content=o.bytes();break;default:o.skipType(l&7);break}}return r},fromJSON(e){return{type:E(e.type)?y.fromJSON(e.type):void 0,parameters:ve(e.parameters)?Object.entries(e.parameters).reduce((n,[o,i])=>(n[o]=String(i),n),{}):{},fallback:E(e.fallback)?String(e.fallback):void 0,compression:E(e.compression)?De(e.compression):void 0,content:E(e.content)?Ae(e.content):new Uint8Array}},toJSON(e){const n={};return e.type!==void 0&&(n.type=e.type?y.toJSON(e.type):void 0),n.parameters={},e.parameters&&Object.entries(e.parameters).forEach(([o,i])=>{n.parameters[o]=i}),e.fallback!==void 0&&(n.fallback=e.fallback),e.compression!==void 0&&(n.compression=e.compression!==void 0?Re(e.compression):void 0),e.content!==void 0&&(n.content=Ue(e.content!==void 0?e.content:new Uint8Array)),n},fromPartial(e){var n,o,i,r;const l=F();return l.type=e.type!==void 0&&e.type!==null?y.fromPartial(e.type):void 0,l.parameters=Object.entries((n=e.parameters)!==null&&n!==void 0?n:{}).reduce((u,[a,d])=>(d!==void 0&&(u[a]=String(d)),u),{}),l.fallback=(o=e.fallback)!==null&&o!==void 0?o:void 0,l.compression=(i=e.compression)!==null&&i!==void 0?i:void 0,l.content=(r=e.content)!==null&&r!==void 0?r:new Uint8Array,l}};function x(){return{key:"",value:""}}const H={encode(e,n=t.Writer.create()){return e.key!==""&&n.uint32(10).string(e.key),e.value!==""&&n.uint32(18).string(e.value),n},decode(e,n){const o=e instanceof t.Reader?e:new t.Reader(e);let i=n===void 0?o.len:o.pos+n;const r=x();for(;o.pos<i;){const l=o.uint32();switch(l>>>3){case 1:r.key=o.string();break;case 2:r.value=o.string();break;default:o.skipType(l&7);break}}return r},fromJSON(e){return{key:E(e.key)?String(e.key):"",value:E(e.value)?String(e.value):""}},toJSON(e){const n={};return e.key!==void 0&&(n.key=e.key),e.value!==void 0&&(n.value=e.value),n},fromPartial(e){var n,o;const i=x();return i.key=(n=e.key)!==null&&n!==void 0?n:"",i.value=(o=e.value)!==null&&o!==void 0?o:"",i}};var p=(()=>{if(typeof p<"u")return p;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw"Unable to locate global object"})();function Ae(e){if(p.Buffer)return Uint8Array.from(p.Buffer.from(e,"base64"));{const n=p.atob(e),o=new Uint8Array(n.length);for(let i=0;i<n.length;++i)o[i]=n.charCodeAt(i);return o}}function Ue(e){if(p.Buffer)return p.Buffer.from(e).toString("base64");{const n=[];return e.forEach(o=>{n.push(String.fromCharCode(o))}),p.btoa(n.join(""))}}t.util.Long!==f&&(t.util.Long=f,t.configure());function ve(e){return typeof e=="object"&&e!==null}function E(e){return e!=null}var Z=(()=>{if(typeof Z<"u")return Z;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw"Unable to locate global object"})();t.util.Long!==f&&(t.util.Long=f,t.configure());t.util.Long!==f&&(t.util.Long=f,t.configure());var $=(()=>{if(typeof $<"u")return $;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw"Unable to locate global object"})();t.util.Long!==f&&(t.util.Long=f,t.configure());t.util.Long!==f&&(t.util.Long=f,t.configure());var j;(function(e){e[e.ERROR_CODE_UNSPECIFIED=0]="ERROR_CODE_UNSPECIFIED",e[e.ERROR_CODE_INVALID_INPUT=1]="ERROR_CODE_INVALID_INPUT",e[e.ERROR_CODE_NO_MATCHING_PREKEY=2]="ERROR_CODE_NO_MATCHING_PREKEY",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"})(j||(j={}));var B;(function(e){e[e.JOB_TYPE_UNSPECIFIED=0]="JOB_TYPE_UNSPECIFIED",e[e.JOB_TYPE_REFRESH_V1=1]="JOB_TYPE_REFRESH_V1",e[e.JOB_TYPE_REFRESH_V2=2]="JOB_TYPE_REFRESH_V2",e[e.JOB_TYPE_REFRESH_PPPP=3]="JOB_TYPE_REFRESH_PPPP",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"})(B||(B={}));var V;(function(e){e[e.KEYSTORE_STATUS_UNSPECIFIED=0]="KEYSTORE_STATUS_UNSPECIFIED",e[e.KEYSTORE_STATUS_UNINITIALIZED=1]="KEYSTORE_STATUS_UNINITIALIZED",e[e.KEYSTORE_STATUS_INITIALIZED=2]="KEYSTORE_STATUS_INITIALIZED",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"})(V||(V={}));var X=(()=>{if(typeof X<"u")return X;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw"Unable to locate global object"})();t.util.Long!==f&&(t.util.Long=f,t.configure());var J=(()=>{if(typeof J<"u")return J;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw"Unable to locate global object"})();t.util.Long!==f&&(t.util.Long=f,t.configure());var K=(()=>{if(typeof K<"u")return K;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw"Unable to locate global object"})();t.util.Long!==f&&(t.util.Long=f,t.configure());var W=(()=>{if(typeof W<"u")return W;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw"Unable to locate global object"})();t.util.Long!==f&&(t.util.Long=f,t.configure());t.util.Long!==f&&(t.util.Long=f,t.configure());var Q;(function(e){e[e.SORT_DIRECTION_UNSPECIFIED=0]="SORT_DIRECTION_UNSPECIFIED",e[e.SORT_DIRECTION_ASCENDING=1]="SORT_DIRECTION_ASCENDING",e[e.SORT_DIRECTION_DESCENDING=2]="SORT_DIRECTION_DESCENDING",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"})(Q||(Q={}));var q=(()=>{if(typeof q<"u")return q;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw"Unable to locate global object"})();t.util.Long!==f&&(t.util.Long=f,t.configure());var z;(function(e){e[e.ADMIN_LIST_UPDATE_TYPE_UNSPECIFIED=0]="ADMIN_LIST_UPDATE_TYPE_UNSPECIFIED",e[e.ADMIN_LIST_UPDATE_TYPE_ADD_ADMIN=1]="ADMIN_LIST_UPDATE_TYPE_ADD_ADMIN",e[e.ADMIN_LIST_UPDATE_TYPE_REMOVE_ADMIN=2]="ADMIN_LIST_UPDATE_TYPE_REMOVE_ADMIN",e[e.ADMIN_LIST_UPDATE_TYPE_ADD_SUPER_ADMIN=3]="ADMIN_LIST_UPDATE_TYPE_ADD_SUPER_ADMIN",e[e.ADMIN_LIST_UPDATE_TYPE_REMOVE_SUPER_ADMIN=4]="ADMIN_LIST_UPDATE_TYPE_REMOVE_SUPER_ADMIN",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"})(z||(z={}));var ee=(()=>{if(typeof ee<"u")return ee;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw"Unable to locate global object"})();t.util.Long!==f&&(t.util.Long=f,t.configure());var ne;(function(e){e[e.ASSOCIATION_TEXT_VERSION_UNSPECIFIED=0]="ASSOCIATION_TEXT_VERSION_UNSPECIFIED",e[e.ASSOCIATION_TEXT_VERSION_1=1]="ASSOCIATION_TEXT_VERSION_1",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"})(ne||(ne={}));var te=(()=>{if(typeof te<"u")return te;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw"Unable to locate global object"})();t.util.Long!==f&&(t.util.Long=f,t.configure());var oe;(function(e){e[e.COMPRESSION_DEFLATE=0]="COMPRESSION_DEFLATE",e[e.COMPRESSION_GZIP=1]="COMPRESSION_GZIP",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"})(oe||(oe={}));var re=(()=>{if(typeof re<"u")return re;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw"Unable to locate global object"})();t.util.Long!==f&&(t.util.Long=f,t.configure());var ie=(()=>{if(typeof ie<"u")return ie;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw"Unable to locate global object"})();t.util.Long!==f&&(t.util.Long=f,t.configure());t.util.Long!==f&&(t.util.Long=f,t.configure());var fe;(function(e){e[e.CONVERSATION_TYPE_UNSPECIFIED=0]="CONVERSATION_TYPE_UNSPECIFIED",e[e.CONVERSATION_TYPE_GROUP=1]="CONVERSATION_TYPE_GROUP",e[e.CONVERSATION_TYPE_DM=2]="CONVERSATION_TYPE_DM",e[e.CONVERSATION_TYPE_SYNC=3]="CONVERSATION_TYPE_SYNC",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"})(fe||(fe={}));t.util.Long!==f&&(t.util.Long=f,t.configure());t.util.Long!==f&&(t.util.Long=f,t.configure());var le=(()=>{if(typeof le<"u")return le;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw"Unable to locate global object"})();t.util.Long!==f&&(t.util.Long=f,t.configure());t.util.Long!==f&&(t.util.Long=f,t.configure());var ue=(()=>{if(typeof ue<"u")return ue;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw"Unable to locate global object"})();t.util.Long!==f&&(t.util.Long=f,t.configure());var ae=(()=>{if(typeof ae<"u")return ae;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw"Unable to locate global object"})();t.util.Long!==f&&(t.util.Long=f,t.configure());var de=(()=>{if(typeof de<"u")return de;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw"Unable to locate global object"})();t.util.Long!==f&&(t.util.Long=f,t.configure());class S{constructor(n){if(!n.aes256GcmHkdfSha256)throw new Error("invalid ciphertext");if(n.aes256GcmHkdfSha256.payload.length<16)throw new Error(`invalid ciphertext ciphertext length: ${n.aes256GcmHkdfSha256.payload.length}`);if(n.aes256GcmHkdfSha256.hkdfSalt.length!==32)throw new Error(`invalid ciphertext salt length: ${n.aes256GcmHkdfSha256.hkdfSalt.length}`);if(n.aes256GcmHkdfSha256.gcmNonce.length!==12)throw new Error(`invalid ciphertext nonce length: ${n.aes256GcmHkdfSha256.gcmNonce.length}`);this.aes256GcmHkdfSha256=n.aes256GcmHkdfSha256}toBytes(){return A.encode(this).finish()}static fromBytes(n){return new S(A.decode(n))}}const _=window.crypto,Ce=new Uint8Array().buffer;new Uint8Array().buffer;async function me(e,n,o){const i=_.getRandomValues(new Uint8Array(32)),r=_.getRandomValues(new Uint8Array(12)),l=await ye(n,i),u=await _.subtle.encrypt(_e(r),l,e);return new S({aes256GcmHkdfSha256:{payload:new Uint8Array(u),hkdfSalt:i,gcmNonce:r}})}async function Pe(e,n,o){if(!e.aes256GcmHkdfSha256)throw new Error("invalid payload ciphertext");const i=await ye(n,e.aes256GcmHkdfSha256.hkdfSalt),r=await _.subtle.decrypt(_e(e.aes256GcmHkdfSha256.gcmNonce),i,e.aes256GcmHkdfSha256.payload);return new Uint8Array(r)}function _e(e,n){return{name:"AES-GCM",iv:e}}async function ye(e,n){const o=await _.subtle.importKey("raw",e,"HKDF",!1,["deriveKey"]);return _.subtle.deriveKey({name:"HKDF",hash:"SHA-256",salt:n,info:Ce},o,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}I.bytesToHex;var ce;(function(e){e[e.INBOX_KEY=0]="INBOX_KEY",e[e.SEND_KEY=1]="SEND_KEY"})(ce||(ce={}));new f(10**9).mul(10**9);class O{constructor(n){this.authorityId=n.authorityId,this.typeId=n.typeId,this.versionMajor=n.versionMajor,this.versionMinor=n.versionMinor}toString(){return`${this.authorityId}/${this.typeId}:${this.versionMajor}.${this.versionMinor}`}static fromString(n){const[o,i]=n.split(":"),[r,l]=o.split("/"),[u,a]=i.split(".");return new O({authorityId:r,typeId:l,versionMajor:Number(u),versionMinor:Number(a)})}sameAs(n){return this.authorityId===n.authorityId&&this.typeId===n.typeId}}new O({authorityId:"xmtp.org",typeId:"fallback",versionMajor:1,versionMinor:0});new O({authorityId:"xmtp.org",typeId:"text",versionMajor:1,versionMinor:0});var Ee;(function(e){e.utf8="UTF-8"})(Ee||(Ee={}));var se;(function(e){e[e.OK=0]="OK",e[e.CANCELLED=1]="CANCELLED",e[e.UNKNOWN=2]="UNKNOWN",e[e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",e[e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",e[e.NOT_FOUND=5]="NOT_FOUND",e[e.ALREADY_EXISTS=6]="ALREADY_EXISTS",e[e.PERMISSION_DENIED=7]="PERMISSION_DENIED",e[e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",e[e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",e[e.ABORTED=10]="ABORTED",e[e.OUT_OF_RANGE=11]="OUT_OF_RANGE",e[e.UNIMPLEMENTED=12]="UNIMPLEMENTED",e[e.INTERNAL=13]="INTERNAL",e[e.UNAVAILABLE=14]="UNAVAILABLE",e[e.DATA_LOSS=15]="DATA_LOSS",e[e.UNAUTHENTICATED=16]="UNAUTHENTICATED"})(se||(se={}));new Oe.ec("secp256k1");Buffer.from("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141","hex");Buffer.alloc(32,0);new TextEncoder().encode("__XMTP__INVITATION__SALT__XMTP__");var w;(function(e){e[e.none=0]="none",e[e.xmtpTopicStore=1]="xmtpTopicStore"})(w||(w={}));w.none;w.xmtpTopicStore;new O({authorityId:"xmtp.org",typeId:"composite",versionMajor:1,versionMinor:0});const Ie=new R({authorityId:"xmtp.org",typeId:"attachment",versionMajor:1,versionMinor:0});class Ze{get contentType(){return Ie}encode(n){return{type:Ie,parameters:{filename:n.filename,mimeType:n.mimeType},content:n.data}}decode(n){return{filename:n.parameters.filename,mimeType:n.parameters.mimeType,data:n.content}}fallback(n){return`Can’t display "${n.filename}". This app doesn’t support attachments.`}shouldPush(){return!0}}const T=window.crypto,ge=new R({authorityId:"xmtp.org",typeId:"remoteStaticAttachment",versionMajor:1,versionMinor:0});class $e{static async load(n,o){const i=await fetch(n.url),r=new Uint8Array(await i.arrayBuffer());if(!r)throw new Error(`no payload for remote attachment at ${n.url}`);const l=new Uint8Array(await T.subtle.digest("SHA-256",r));if(I.bytesToHex(l)!==n.contentDigest)throw new Error("content digest does not match");const u=new S({aes256GcmHkdfSha256:{hkdfSalt:n.salt,gcmNonce:n.nonce,payload:r}}),a=await Pe(u,n.secret),d=Y.decode(a);if(!d||!d.type)throw new Error("no encoded content");const s=d.type;if(!s)throw new Error("no content type");const N=o.codecFor(new R(s));if(!N)throw new Error(`no codec found for ${d.type?.typeId}`);return N.decode(d,o)}static async encodeEncrypted(n,o){const i=T.getRandomValues(new Uint8Array(32)),r=Y.encode(o.encode(n,{codecFor(){}})).finish(),l=await me(r,i),u=l.aes256GcmHkdfSha256?.hkdfSalt,a=l.aes256GcmHkdfSha256?.gcmNonce,d=l.aes256GcmHkdfSha256?.payload;if(!u||!a||!d)throw new Error("missing encryption key");const s=new Uint8Array(await T.subtle.digest("SHA-256",d));return{digest:I.bytesToHex(s),secret:i,salt:u,nonce:a,payload:d}}get contentType(){return ge}encode(n){if(!n.url.startsWith("https"))throw new Error("scheme must be https");return{type:ge,parameters:{contentDigest:n.contentDigest,salt:I.bytesToHex(n.salt),nonce:I.bytesToHex(n.nonce),secret:I.bytesToHex(n.secret),scheme:n.scheme,contentLength:String(n.contentLength),filename:n.filename},content:new TextEncoder().encode(n.url)}}decode(n){return{url:new TextDecoder().decode(n.content),contentDigest:n.parameters.contentDigest,salt:I.hexToBytes(n.parameters.salt),nonce:I.hexToBytes(n.parameters.nonce),secret:I.hexToBytes(n.parameters.secret),scheme:n.parameters.scheme,contentLength:parseInt(n.parameters.contentLength,10),filename:n.parameters.filename}}fallback(n){return`Can’t display "${n.filename}". This app doesn’t support attachments.`}shouldPush(){return!0}}export{Fe as a,Ye as b,Ze as c,xe as g,He as i,ge as m,$e as p,Ie as s};
