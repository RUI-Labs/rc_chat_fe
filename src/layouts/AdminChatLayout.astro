---
import "@/styles/globals.css";
import SignOutButton from "@/components/SignOutButton.vue";
// import { Button } from "@/components/ui/button";
// import ProjectDropdown from "@/components/admin/ProjectDropdown.vue";
// import NewChatDialog from "@/components/admin/NewChatDialog.vue";
import Xmtpclient from "@/components/admin/Xmtpclient.vue";
import NavButtons from "@/components/admin/NavButtons.vue";


// const url = Astro.url.pathname
// match the pattern to get project slug /admin/project/<id>/...
// let projectSlug = url.match(/\/admin\/project\/([^\/]*)/)?.[1]
// const selectedProject = (project:any) => {
//   console.log(project)
// }

---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/remo.svg" />
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />
    <title>REMO :: Admin</title>

    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous" />
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="anonymous" />
    <link href="https://fonts.googleapis.com/css2?family=Sora:wght@100..800&display=swap" rel="stylesheet" crossorigin="anonymous" />
  </head>

  <body class="w-full h-screen grid grid-rows-[auto_auto_1fr] grid-cols-3 bg-bremo-900">
    <script>
      import "iconify-icon";

      import 'overlayscrollbars/overlayscrollbars.css';
      import { 
        OverlayScrollbars,
      } from 'overlayscrollbars';

      if(document?.querySelector('#userlistParent') != null){
        let _body = document.querySelector('#userlistParent') as any;
        OverlayScrollbars( _body, {
            scrollbars : {
                autoHide: "leave",
                autoHideDelay: 500
            },
        });
      }

      if(document?.querySelector('#chatParent') != null){
        let _body = document.querySelector('#chatParent') as any;
        OverlayScrollbars( _body, {
            scrollbars : {
                autoHide: "leave",
                autoHideDelay: 500
            },
        });
      }

      import { Buffer } from "buffer";

			window.Buffer = window.Buffer ?? Buffer;


    </script>

<nav class="col-span-full w-full border-b border-b-bremo-700 bg-bremo-800 p-4 grid grid-cols-3 h-18">
  <div class="w-full flex justify-start items-center space-x-2 col-span-2">

    <a class="flex justify-start items-center flex-shrink-0" href="/admin">
      <img class="rounded-md overflow-hidden w-9 h-9" src="/logo.png">
      <div class="hidden lg:block font-brand font-bold text-lg ml-2 mr-4 text-white">REMO</div>
    </a>

    <!-- <div class="w-[200px] flex justify-center items-center">
      <ProjectDropdown client:only="vue" wallet={Astro.locals.user?.id}/>
    </div> -->
    <!-- <a href={`/admin/project/${projectSlug}`}>
      <Button class="text-white hover:bg-bremo-700 hover:text-bremo-100" variant="ghost">Campaigns</Button>
    </a>
    <a href={`/admin/project/${projectSlug}/users`}>
      <Button class="text-white hover:bg-bremo-700 hover:text-bremo-100" variant="ghost">Users</Button>
    </a>
    <a href={`/admin/project/${projectSlug}/chat`}>
      <Button class="text-white hover:bg-bremo-700 hover:text-bremo-100" variant="ghost">Chat</Button>
    </a> -->
    <NavButtons wallet={Astro.locals.user?.id}  client:only></NavButtons>
  </div>

  <div class="w-full flex justify-end items-center">
    <Xmtpclient client:only="vue" />
    <SignOutButton client:only="vue" />
  </div>
</nav>



    <div class="p-4 py-6 flex justify-between items-center w-full col-span-full border-b border-b-bremo-700 bg-bremo-900">
      <h1 class="text-3xl pl-4 font-brand font-bold text-white">Chat</h1>

      <!-- <NewChatDialog client:only="vue">
        <Button class="bg-blue-500">New</Button>
      </NewChatDialog> -->
    </div>

    <div id="userlistParent"class="border-r border-r-bremo-700 h-full ">
        <div id="userlist"></div>
    </div>

    <div class="col-span-2 grid grid-cols-1 grid-rows-[1fr_auto] overflow-hidden">
        <div id="chatParent"class="h-full w-full col-span-2 relative ">
            <div id="chatBox"></div>
        </div>

        <slot></slot>
    </div>

  </body>
</html>
